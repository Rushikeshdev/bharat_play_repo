{% csrf_token %}
<script>

$(document).ready(function() {
            $("#loginForm").submit(function(event) {
                var csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                event.preventDefault();
                console.log("hello");
                var formData = $(this).serialize();
                console.log(formData);
                $.ajax({
                    type: "POST",
                    url: "/userlogin/",
                    data: formData,
                    beforeSend: function(xhr, settings) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    },
                    success: function(response) {
                        // If login is successful, display success message
                        console.log("success",response);
                        if (response.user == 'is_admin'){

                            var popup= $.confirm({
                                title: ``,
                                content:"Admin Login Successfully!",
                                type: "green",
                                typeAnimated: true,
                                columnClass: 'medium',
                                buttons: {
                                // OK: {
                                //     text: "Close",
                                //     btnClass: "btn-blue",
                                //     action: function () {
                                //         window.location.href = "/withdrawal-requests/"; 
                                //     }
                                
                                    
                                // },

                            
                            },

                            

                            
                        
                        });

                        setTimeout(function() {
                        popup.close();
                        window.location.href = "/withdrawal-requests/"; 
                        }, 1000); // Close after 3 seconds

                        

                            
                            


                        }
                        if (response.user == 'is_superadmin'){

                           var popup= $.confirm({
                            title: ``,
                            content:"SuperAdmin Login Successfully!",
                            type: "green",
                            typeAnimated: true,
                            columnClass: 'medium',
                            autoClose: 'close|0000',
                            buttons: {
                            // OK: {
                            //     text: "Close",
                            //     btnClass: "btn-blue",
                            //     close: function () {},
                            //     action: function () {
                            //         window.location.href = "/admin_dashboard/template/"; 
                            //     }
                            
                                
                            // },
                           

                            },

                            


                            });

                            setTimeout(function() {
                                popup.close();
                                window.location.href = "/admin_dashboard/template/"; 
                            }, 1000); // Close after 3 seconds

                           



                        }
                        if (response.user == 'is_client'){

                          var popup=  $.confirm({
                            title: ``,
                            content:"Client Login Successfully!",
                            type: "green",
                            typeAnimated: true,
                            columnClass: 'medium',
                            buttons: {
                            // OK: {
                            //     text: "Close",
                            //     btnClass: "btn-blue",
                            //     action: function () {
                            //         window.location.href = "/dashboard_client/template/"; 
                            //     }
                               
                                
                            // },
                            
                            },
                            
                            
                            
                        
                        });

                        setTimeout(function() {
                        popup.close();
                        window.location.href = "/dashboard_client/template/"; 
                        }, 1000); // Close after 3 seconds
                        

                           
                        }
                      
                    },
                    error: function(xhr, status, error) {
                        // If login fails, display error message
                        var popup=$.confirm({
                            title:'',
                            content:'User Is Not Authenticated',
                            type:'red',
                            typeAnimated:true,
                            // buttons:{
                            //             tryAgain: {
                            //                 // text: 'Try again',
                            //                 // btnClass: 'btn-red',
                            //                 action: function () {
                            //                     window.location.reload(); // Reload the page
                            //                 }
                                            
                            //             },
                                                    
                            //         }

                            // action: function () {
                            //         window.location.href = "/admin_dashboard/template/"; 
                            //     }

                        });

                        setTimeout(function() {
                        popup.close();
                        window.location.reload(); 
                        }, 1000); // Close after 3 seconds
                        


                    }
                });
            });
        });


</script>