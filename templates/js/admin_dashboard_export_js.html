

<script>
$(document).ready(function() {
    $('#exportBtn').click(function() {
        // Make an AJAX request to fetch the data
        $.ajax({
            url: '/admin_dashboard/template', 
            type: 'GET',
            success: function(response) {
               
                var data = [];
                var headers = [
                    "Sr.No",
                    "Client Name",
                    "Credit",
                    "Debit",
                    "Status",
                    "Admin",
                    "Approved By",
                  
                    "Bene Name",
                    "Bene Account Number",
                    "Bene Bank Name",
                    "Bene IFSC Code",
                    "Bene Mode",
                    "Bene Deposit",
                    "Bene Withdraw",
                    "Bene Status",
                    "Bene Remarks",
                    "Bene UTR",
                    "Created Date",
                ];
                data.push(headers);
                
                // Process the response data
                $.each(response.withdrawal_requests, function(index, entry) {
                    var row = [];
                    console.log("ENTERY",entry.is_wallet);
                    if (entry.is_wallet) {
                        
                        // Process client wallet statement
                        row.push(index + 1); // Serial number
                        row.push(entry.client_email);
                        row.push(entry.deposit);
                        row.push(entry.withdraw);
                        row.push(entry.status);
                        row.push(entry.admin_remark_superadmin);
                        row.push(''); // Approved By (not available in client wallet statement)
                       
                        row.push(''); // Bene Name
                        row.push(''); // Bene Account Number
                        row.push(''); // Bene Bank Name
                        row.push(''); // Bene IFSC Code
                        row.push(''); // Bene Mode
                        row.push(''); // Bene Deposit
                        row.push(''); // Bene Withdraw
                        row.push(''); // Bene Status
                        row.push(entry.admin_remark_superadmin); // Bene Remarks
                        row.push(entry.utr_number_superadmin_narration); // Bene UTR
                        row.push(entry.created_at);
                    } else {

                       

                        // Process withdrawal request
                        row.push(index + 1); // Serial number
                        row.push(entry.client_email);
                        row.push(entry.deposit);
                        row.push(entry.withdraw);
                        row.push(entry.status);
                        row.push(entry.admin_remark);
                        row.push(entry.status_change_by);
                       
                        
                        row.push(entry.bene_account_name);
                        row.push(entry.bene_account_number);
                        row.push(entry.bene_bank_name);
                        row.push(entry.bene_branch_ifsc);

                        row.push(entry.tnx);
                        row.push(entry.deposit);
                        row.push(entry.withdraw);
                        row.push(entry.status);

                        row.push(entry.admin_remark);
                        row.push(entry.utr_number);
                        row.push(entry.created_at);
                    }
                    data.push(row);
                });

                // Convert the extracted data to a worksheet
                var worksheet = XLSX.utils.aoa_to_sheet(data);

                // Create a new workbook and append the worksheet
                var workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

                // Export the workbook to an Excel file
                XLSX.writeFile(workbook, 'superadmin_dashboard_data.xlsx');
            },
            error: function(xhr, status, error) {
                console.error('Error fetching data:', error);
                
            }
        });
    });
});
</script>
