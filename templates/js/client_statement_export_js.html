<script>
    $(document).ready(function() {
        $('#client_statement_exportBtn').click(function() {


            // Make an AJAX request to fetch the data
        $.ajax({
            url: '/account_statement/template/', 
            type: 'GET',
            success: function(response) {
               
                var data = [];
                var headers = [
                    "Sr.No",
                    "Narration",
                    "Deposit",
                    "Withdraw",
                    "Status",
                    "Balance",
        
                  
                    "Bene Name",
                    "Bene Account Number",
                    "Bene Bank Name",
                    "Bene IFSC Code",
                    "Bene Mode",

                    "Bene Remarks",
                    "Created Date",
                ];
                data.push(headers);
                
                // Process the response data
                $.each(response.withdrawal_requests, function(index, entry) {
                    var row = [];
                    
                     

                       

                        // Process withdrawal request
                        row.push(index + 1); // Serial number
                        row.push(entry.narration);
                        row.push(entry.deposit);
                        row.push(entry.withdraw);
                
                        row.push(entry.status);
                        row.push(entry.mode);
                        
                        row.push(entry.bene_account_name);
                        row.push(entry.bene_account_number);
                        row.push(entry.bene_bank_name);
                        row.push(entry.bene_branch_ifsc);

                       
                       

                        row.push(entry.admin_remark);
                       
                        row.push(entry.created_at);
                    
                    data.push(row);
                });

                // Convert the extracted data to a worksheet
                var worksheet = XLSX.utils.aoa_to_sheet(data);

                // Create a new workbook and append the worksheet
                var workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

                // Export the workbook to an Excel file
                XLSX.writeFile(workbook, 'client_statement_data.xlsx');
            },
            error: function(xhr, status, error) {
                console.error('Error fetching data:', error);
                
            }
        });
            
        });

       
        

    });
</script>