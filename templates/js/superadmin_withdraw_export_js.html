<script>
    $(document).ready(function() {
        $('#superadmin_with_req_Btn').click(function() {


            // Make an AJAX request to fetch the data
        $.ajax({
            url: '/withdrawal-requests/', 
            type: 'GET',
            success: function(response) {
               
                var data = [];
                var headers = [
                    "Sr.No",
                    "Client Name",
                    "Amount",
                    "Status",
        
                  
                    "Bene Name",
                    "Bene Account Number",
                    "Bene Bank Name",
                    "Bene IFSC Code",
                    "Bene Mode",

                    "Bene Remarks",
                    "Bene UTR",
                    "Created Date",
                ];
                data.push(headers);
                
                // Process the response data
                $.each(response.withdrawal_requests, function(index, entry) {
                    var row = [];
                    
                     

                       

                        // Process withdrawal request
                        row.push(index + 1); // Serial number
                        row.push(entry.client_email);
                        row.push(entry.amount);
                
                        row.push(entry.status);
                        
                        
                        row.push(entry.bene_account_name);
                        row.push(entry.bene_account_number);
                        row.push(entry.bene_bank_name);
                        row.push(entry.bene_branch_ifsc);

                        row.push(entry.mode);
                       

                        row.push(entry.admin_remark);
                        row.push(entry.utr_number);
                        row.push(entry.created_at);
                    
                    data.push(row);
                });

                // Convert the extracted data to a worksheet
                var worksheet = XLSX.utils.aoa_to_sheet(data);

                // Create a new workbook and append the worksheet
                var workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

                // Export the workbook to an Excel file
                XLSX.writeFile(workbook, 'superadmin_dashboard_data.xlsx');
            },
            error: function(xhr, status, error) {
                console.error('Error fetching data:', error);
                
            }
        });
            
        });

       
        

    });
</script>